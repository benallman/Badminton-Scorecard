<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>Scoresheet Replica</title>
<style>
  body { 
    font-family: Arial, sans-serif; 
    margin: 20px; 
    background-color: #f8f9fa;
  }
  
  h2 {
    color: #2c3e50;
    text-align: center;
    margin-bottom: 30px;
  }
  
  table { 
    border-collapse: collapse; 
    margin: 0 auto;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    background: white;
  }
  
  td { 
    border: 1px solid #ccc; 
    padding: 8px; 
    text-align: center; 
    min-width: 60px;
  }
  
  input { 
    border: none; 
    width: 100%; 
    height: 100%; 
    box-sizing: border-box; 
    text-align: center; 
    background: transparent;
    font-size: 14px;
  }
  
  input:focus {
    outline: 2px solid #4CAF50;
    background-color: #f0f8f0;
  }
  
  .header-cell {
    background-color: #EFEFEF;
    font-weight: bold;
  }
  
  .home-header {
    background-color: #93C47D;
    color: white;
    font-weight: bold;
  }
  
  .away-header {
    background-color: #76A5AF;
    color: white;
    font-weight: bold;
  }
  
  .calc-cell {
    background-color: #D9D9D9;
    font-weight: bold;
  }
  
  .total-home {
    background-color: #93C47D;
    color: white;
    font-weight: bold;
  }
  
  .total-away {
    background-color: #76A5AF;
    color: white;
    font-weight: bold;
  }
  
  .game-label {
    background-color: #EFEFEF;
    font-weight: bold;
    text-align: left;
    padding-left: 12px;
  }
</style>
</head>
<body>
<h2>Badminton Scoresheet</h2>
<table id="scoreTable">
  <!-- Header Row -->
  <tr>
    <td class="header-cell"></td>
    <td class="home-header">G1 Home</td>
    <td class="away-header">G1 Away</td>
    <td class="home-header">G2 Home</td>
    <td class="away-header">G2 Away</td>
    <td class="home-header">G3 Home</td>
    <td class="away-header">G3 Away</td>
    <td class="header-cell"></td>
    <td class="header-cell">Result 1 (1=Home, 0=Away)</td>
    <td class="header-cell">Result 2</td>
    <td class="header-cell">Result 3</td>
    <td class="header-cell"></td>
    <td class="header-cell">Result</td>
  </tr>
  
  <!-- Game Rows -->
  <tr>
    <td class="game-label">Game 1</td>
    <td><input type="number" min="0" placeholder="0" data-row="1" data-col="home1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="1" data-col="away1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="1" data-col="home2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="1" data-col="away2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="1" data-col="home3"></td>
    <td><input type="number" min="0" placeholder="0" data-row="1" data-col="away3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="win1-1"></td>
    <td class="calc-cell" id="win1-2"></td>
    <td class="calc-cell" id="win1-3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="result-1"></td>
  </tr>
  
  <tr>
    <td class="game-label">Game 2</td>
    <td><input type="number" min="0" placeholder="0" data-row="2" data-col="home1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="2" data-col="away1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="2" data-col="home2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="2" data-col="away2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="2" data-col="home3"></td>
    <td><input type="number" min="0" placeholder="0" data-row="2" data-col="away3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="win2-1"></td>
    <td class="calc-cell" id="win2-2"></td>
    <td class="calc-cell" id="win2-3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="result-2"></td>
  </tr>
  
  <tr>
    <td class="game-label">Game 3</td>
    <td><input type="number" min="0" placeholder="0" data-row="3" data-col="home1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="3" data-col="away1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="3" data-col="home2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="3" data-col="away2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="3" data-col="home3"></td>
    <td><input type="number" min="0" placeholder="0" data-row="3" data-col="away3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="win3-1"></td>
    <td class="calc-cell" id="win3-2"></td>
    <td class="calc-cell" id="win3-3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="result-3"></td>
  </tr>
  
  <tr>
    <td class="game-label">Game 4</td>
    <td><input type="number" min="0" placeholder="0" data-row="4" data-col="home1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="4" data-col="away1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="4" data-col="home2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="4" data-col="away2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="4" data-col="home3"></td>
    <td><input type="number" min="0" placeholder="0" data-row="4" data-col="away3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="win4-1"></td>
    <td class="calc-cell" id="win4-2"></td>
    <td class="calc-cell" id="win4-3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="result-4"></td>
  </tr>
  
  <tr>
    <td class="game-label">Game 5</td>
    <td><input type="number" min="0" placeholder="0" data-row="5" data-col="home1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="5" data-col="away1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="5" data-col="home2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="5" data-col="away2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="5" data-col="home3"></td>
    <td><input type="number" min="0" placeholder="0" data-row="5" data-col="away3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="win5-1"></td>
    <td class="calc-cell" id="win5-2"></td>
    <td class="calc-cell" id="win5-3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="result-5"></td>
  </tr>
  
  <tr>
    <td class="game-label">Game 6</td>
    <td><input type="number" min="0" placeholder="0" data-row="6" data-col="home1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="6" data-col="away1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="6" data-col="home2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="6" data-col="away2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="6" data-col="home3"></td>
    <td><input type="number" min="0" placeholder="0" data-row="6" data-col="away3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="win6-1"></td>
    <td class="calc-cell" id="win6-2"></td>
    <td class="calc-cell" id="win6-3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="result-6"></td>
  </tr>
  
  <tr>
    <td class="game-label">Game 7</td>
    <td><input type="number" min="0" placeholder="0" data-row="7" data-col="home1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="7" data-col="away1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="7" data-col="home2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="7" data-col="away2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="7" data-col="home3"></td>
    <td><input type="number" min="0" placeholder="0" data-row="7" data-col="away3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="win7-1"></td>
    <td class="calc-cell" id="win7-2"></td>
    <td class="calc-cell" id="win7-3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="result-7"></td>
  </tr>
  
  <tr>
    <td class="game-label">Game 8</td>
    <td><input type="number" min="0" placeholder="0" data-row="8" data-col="home1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="8" data-col="away1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="8" data-col="home2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="8" data-col="away2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="8" data-col="home3"></td>
    <td><input type="number" min="0" placeholder="0" data-row="8" data-col="away3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="win8-1"></td>
    <td class="calc-cell" id="win8-2"></td>
    <td class="calc-cell" id="win8-3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="result-8"></td>
  </tr>
  
  <tr>
    <td class="game-label">Game 9</td>
    <td><input type="number" min="0" placeholder="0" data-row="9" data-col="home1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="9" data-col="away1"></td>
    <td><input type="number" min="0" placeholder="0" data-row="9" data-col="home2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="9" data-col="away2"></td>
    <td><input type="number" min="0" placeholder="0" data-row="9" data-col="home3"></td>
    <td><input type="number" min="0" placeholder="0" data-row="9" data-col="away3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="win9-1"></td>
    <td class="calc-cell" id="win9-2"></td>
    <td class="calc-cell" id="win9-3"></td>
    <td class="header-cell"></td>
    <td class="calc-cell" id="result-9"></td>
  </tr>
  
  <!-- Spacer Row -->
  <tr>
    <td class="header-cell" colspan="13"></td>
  </tr>
  
  <!-- Totals Row -->
  <tr>
    <td class="header-cell">Totals</td>
    <td class="calc-cell" id="total-home1"></td>
    <td class="calc-cell" id="total-away1"></td>
    <td class="calc-cell" id="total-home2"></td>
    <td class="calc-cell" id="total-away2"></td>
    <td class="calc-cell" id="total-home3"></td>
    <td class="calc-cell" id="total-away3"></td>
    <td class="header-cell"></td>
    <td class="total-home" id="points-home">0</td>
    <td class="total-away" id="points-away">0</td>
    <td class="header-cell"><strong>Points (H v A)</strong></td>
    <td class="header-cell"></td>
    <td class="header-cell"></td>
  </tr>
  
  <!-- Rubbers Won Row -->
  <tr>
    <td class="header-cell"></td>
    <td class="header-cell" colspan="6"></td>
    <td class="header-cell"></td>
    <td class="total-home" id="rubbers-home">0</td>
    <td class="total-away" id="rubbers-away">0</td>
    <td class="header-cell"><strong>Rubbers Won (H v A)</strong></td>
    <td class="header-cell"></td>
    <td class="header-cell"></td>
  </tr>
  
  <!-- Results Summary Row -->
  <tr>
    <td class="header-cell"></td>
    <td class="header-cell" colspan="6"></td>
    <td class="header-cell"></td>
    <td class="total-home" id="games-home">0</td>
    <td class="total-away" id="games-away">0</td>
    <td class="header-cell"><strong>Games Won (H v A)</strong></td>
    <td class="header-cell"></td>
    <td class="header-cell"></td>
  </tr>
</table>

<script>
function calculateScores() {
  // Calculate individual game winners and results
  for (let row = 1; row <= 9; row++) {
    let wins = 0;
    
    // Check each of the 3 games in this row
    for (let game = 1; game <= 3; game++) {
      const homeInput = document.querySelector(`input[data-row="${row}"][data-col="home${game}"]`);
      const awayInput = document.querySelector(`input[data-row="${row}"][data-col="away${game}"]`);
      
      const homeScore = parseFloat(homeInput.value) || 0;
      const awayScore = parseFloat(awayInput.value) || 0;
      
      const winCell = document.getElementById(`win${row}-${game}`);
      
      if (homeInput.value !== '' || awayInput.value !== '') {
        if (homeScore > awayScore) {
          winCell.textContent = '1';
          wins++;
        } else {
          winCell.textContent = '0';
        }
      } else {
        winCell.textContent = '';
      }
    }
    
    // Calculate overall result for this row (1 if home wins 2+ games)
    const resultCell = document.getElementById(`result-${row}`);
    const hasAnyInput = document.querySelectorAll(`input[data-row="${row}"]`).length > 0 &&
                       Array.from(document.querySelectorAll(`input[data-row="${row}"]`)).some(inp => inp.value !== '');
    
    if (hasAnyInput) {
      resultCell.textContent = wins >= 2 ? '1' : '0';
    } else {
      resultCell.textContent = '';
    }
  }
  
  // Calculate column totals
  for (let game = 1; game <= 3; game++) {
    let homeTotal = 0;
    let awayTotal = 0;
    let hasHomeValues = false;
    let hasAwayValues = false;
    
    for (let row = 1; row <= 9; row++) {
      const homeInput = document.querySelector(`input[data-row="${row}"][data-col="home${game}"]`);
      const awayInput = document.querySelector(`input[data-row="${row}"][data-col="away${game}"]`);
      
      if (homeInput.value !== '') {
        homeTotal += parseFloat(homeInput.value) || 0;
        hasHomeValues = true;
      }
      if (awayInput.value !== '') {
        awayTotal += parseFloat(awayInput.value) || 0;
        hasAwayValues = true;
      }
    }
    
    document.getElementById(`total-home${game}`).textContent = hasHomeValues ? homeTotal : '';
    document.getElementById(`total-away${game}`).textContent = hasAwayValues ? awayTotal : '';
  }
  
  // Calculate overall points (sum of all home scores vs all away scores)
  let totalHomePoints = 0;
  let totalAwayPoints = 0;
  let hasAnyValues = false;
  
  for (let game = 1; game <= 3; game++) {
    const homeTotal = document.getElementById(`total-home${game}`).textContent;
    const awayTotal = document.getElementById(`total-away${game}`).textContent;
    
    if (homeTotal !== '') {
      totalHomePoints += parseFloat(homeTotal);
      hasAnyValues = true;
    }
    if (awayTotal !== '') {
      totalAwayPoints += parseFloat(awayTotal);
      hasAnyValues = true;
    }
  }
  
  document.getElementById('points-home').textContent = hasAnyValues ? totalHomePoints : '0';
  document.getElementById('points-away').textContent = hasAnyValues ? totalAwayPoints : '0';
  
  // Calculate rubbers won (count of individual game wins)
  let homeRubbersWon = 0;
  let awayRubbersWon = 0;
  
  for (let row = 1; row <= 9; row++) {
    for (let game = 1; game <= 3; game++) {
      const winCell = document.getElementById(`win${row}-${game}`);
      if (winCell.textContent === '1') {
        homeRubbersWon++;
      } else if (winCell.textContent === '0') {
        awayRubbersWon++;
      }
    }
  }
  
  document.getElementById('rubbers-home').textContent = homeRubbersWon;
  document.getElementById('rubbers-away').textContent = awayRubbersWon;
  
  // Calculate games won (count of 1s in result column)
  let homeGamesWon = 0;
  let awayGamesWon = 0;
  
  for (let row = 1; row <= 9; row++) {
    const resultCell = document.getElementById(`result-${row}`);
    if (resultCell.textContent === '1') {
      homeGamesWon++;
    } else if (resultCell.textContent === '0') {
      awayGamesWon++;
    }
  }
  
  document.getElementById('games-home').textContent = homeGamesWon;
  document.getElementById('games-away').textContent = awayGamesWon;
}

// Add event listeners to all inputs
document.querySelectorAll('input').forEach(input => {
  input.addEventListener('input', calculateScores);
  input.addEventListener('change', calculateScores);
});

// Initial calculation
calculateScores();
</script>
</body>
</html>